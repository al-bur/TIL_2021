## [210123] 프로세스, 쓰레드, 가상메모리 (기본개념)

### 1. 주제를 고른 이유에 대하여

---

파이썬, 알고리즘을 공부하면서 코딩이란 것이 무엇인가 생각하다가 -> 이런 모든 코딩은 컴퓨터와 사람간의 의사소통을 할 수 있는 약속이구나라는 것을 알게 되었습니다.

그러면 컴퓨터와 의사소통을 잘하기 위해서 프로그래밍 언어, 알고리즘, 여러 툴등등을 배우고 있는데 정작 얘기하고 싶은 `컴퓨터`라는 주체 자체에 대해서는 잘 모르는 구나라는 생각을 했습니다.

그래서 현재 Computer Systems - A Programmer's Perspective'라는 책으로 `컴퓨터`에 대하여 공부하기 시작했습니다.
오늘은 프로세스, 쓰레드, 가상메모리에 대하여 간단하게 기본 개념을 정리해보고자 합니다.



### 2. 프로세스란?

---

> `프로세스`는 실행 중인 프로그램에 대한 운영체제의 추상화다. 다수의 `프로세스`들은 동일한 시스템에서 동시에 실행될 수 있으며, 각 `프로세스`는 하드웨어를 배타적으로 사용하는 것처럼 느낀다.  대부분의 시스템에서 `프로세스`를 실행할 CPU의 숫자보다 더 많은 `프로세스들`이 존재한다. 한 개의 CPU를 가지는 프로세서 시스템은 `단일 프로세서 시스템`이라고 한다. 
>
> 운영체제는 프로세스가 실행하는 데 필요한 모든 상태정보의 변화를 추적한다. 이 컨텍스트라고 부르는 상태정보는 PC, 레지스터 파일, 메인 메모리의 현재 값을 포함하고 있다. 단일 프로세서 시스템은 한 개의 `프로세스`의 코드만을 실행 할 수 있다. 운영체제는 현재 `프로세스`에서 다른 새로운 `프로세스`로 제어를 옮기려고 할 때 현재 `프로세스`의 컨텍스트를 저장하고 새 `프로세스`의 컨텍스트를 복원시키는 문맥전환을 실행하여 제어권을 새 `프로세스`로 넘겨준다.
>
> 하나의 `프로세스`에서 다른 `프로세스`로의 전환은 운영체제 커널에 의해 관리된다. 커널은 운영체제 코드의 일부분으로 메모리에 상주한다.  응용 프로그램이 운영체제에 의한 어떤 작업을 요청하면, 컴퓨터는 파일 읽기나 쓰기와 같은 특정 시스템 콜을 실행해서 커널에 제어를 넘겨준다. 그러면 커널은 요청된 작업을 수행하고 응용프로그램으로 리턴한다. 단, 커널은 `프로세스`가 아니다. 커널은 모든 `프로세스`를 관리하기 위해 시스템이 이용하는 코드와 자료 구조의 집합이다.

​	

### 3. 쓰레드란?

---

> 최근의 시스템에서는 프로세스가 실제로 `쓰레드(Thread)`라고 하는 다수의 실행 유닛으로 구성되어 있다. 각각의 쓰레드는 해당 프로세스의 컨텍스트에서 실행되며 동일한 코드와 전역 데이터를 공유한다. `쓰레드`는 프로그래밍 모델로서의 중요성이 더욱 커지고 있는데, 이유는 다수의 프로세스들에서보다 데이터의 공유가 더 쉽다는 점과 `쓰레드`가 프로세스보다 더 효율적이라는 점 때문이다. 



### 4. 가상메모리

---

> `가상메모리`는 각 프로세스들이 메인 메모리 전체를 독점적으로 사용하고 있는 것 같은 환상을 제공하는 추상화이다. 각 프로세스는 가상주소 공간이라고 하는 균일한 메모리의 모습을 갖게 된다. 
>
> 각 프로세스들에게 보여지는 가상주소공간은 몇 개의 정의된 영역으로 구성되어 있다. 
>
> 1. 프로그램 코드와 데이터 : 코드는 모든 프로세스들이 같은 고정 주소에서 시작하며, 다음에 C 전역변수에 대응되는 데이터 위치들이 따라온다.
> 2. 힙(Heap) : 런타임 힙이 그 다음으로 따라온다. 힙은 프로세스가 실행되면서 C 표준함수인 malloc이나 free를 호출하면서 런타임에 동적으로 그 크기가 늘었다 줄었다 한다.
> 3. 공유 라이브러리 : 주소 공간의 중간 부근에 공유 라이브러리의 코드와 데이터를 저장하는 영역이 있다.
> 4.  스택(Stack) : 사용자 가상메모리 공간의 맨 위에 컴파일러가 함수 호출을 구현하기 위해 사용하는 사용자 스택이 위치한다. 
> 5. 커널 가상 메모리 : 주소공간의 맨 윗 부분은 커널을 위해 예약되어 있다. 
>
> `가상메모리`가 작동하기 위해서는 프로세서가 만들어내는 모든 주소를 하드웨어로 번역하는 등의 하드웨어와 운영체제 소프트웨어 간의 복잡한 상호작용이 필요하다. 기본적인 아이디어는 프로세스의 가상메모리의 내용을 디스크에 저장하고 메인 메모리를 디스크의 캐시로 사용하는 것이다.
